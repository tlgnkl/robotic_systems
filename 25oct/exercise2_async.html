<!DOCTYPE html>
<html>
<head>
    <title>Async/Await Practice</title>
    <style>
        .container { max-width: 820px; margin: 0 auto; padding: 20px; }
        .button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; color: #fff; }
        .success { background-color: #4CAF50; }
        .info { background-color: #2196F3; }
        .error { background-color: #f44336; }
        .user-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 8px; background: #fff; }
        .user-card.error { border-color: #f44336; background: #ffebee; }
        .loading { opacity: 0.6; }
        .log { margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 5px; }
        .log-entry { margin: 5px 0; padding: 5px; border-left: 3px solid #ccc; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚è≥ –ü—Ä–∞–∫—Ç–∏–∫–∞ —Å async/await</h1>
        
        <button class="button success" id="loadUserBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        <button class="button info" id="parallelBtn">–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã</button>
        <button class="button error" id="errorHandlingBtn">–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</button>
        
        <div id="userContainer"></div>
        <div class="log" id="log2"></div>
    </div>

    <script>
        const userContainer = document.getElementById('userContainer');
        const log2 = document.getElementById('log2');

        function addLog2(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.style.borderLeftColor = type === 'error' ? '#f44336' :
                                        type === 'success' ? '#4CAF50' : '#2196F3';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log2.appendChild(entry);
        }

        function fakeApiRequest(data, delay = 1000, shouldFail = false) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    if (shouldFail) {
                        reject(new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${data}`));
                    } else {
                        resolve({ data, timestamp: new Date().toLocaleTimeString() });
                    }
                }, delay);
            });
        }

        document.getElementById('loadUserBtn').addEventListener('click', async function() {
            addLog2('--- –ó–ê–ì–†–£–ó–ö–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (async/await) ---');
            
            try {
                addLog2('1. –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
                const user = await fakeApiRequest('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 1500);
                addLog2(`2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω: ${user.data}`, 'success');

                addLog2('3. –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å...');
                const profile = await fakeApiRequest('–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 1000);
                addLog2(`4. –ü—Ä–æ—Ñ–∏–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω: ${profile.data}`, 'success');

                addLog2('5. –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏...');
                const settings = await fakeApiRequest('–ù–∞—Å—Ç—Ä–æ–π–∫–∏', 800);
                addLog2(`6. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${settings.data}`, 'success');

                userContainer.innerHTML = `
                    <div class="user-card">
                        <h3>‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!</h3>
                        <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user.data}</p>
                        <p>–ü—Ä–æ—Ñ–∏–ª—å: ${profile.data}</p>
                        <p>–ù–∞—Å—Ç—Ä–æ–π–∫–∏: ${settings.data}</p>
                        <p>–í—Ä–µ–º—è: ${user.timestamp}</p>
                    </div>
                `;
            } catch (error) {
                addLog2(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
                userContainer.innerHTML = `
                    <div class="user-card error">
                        <h3>‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        });

        document.getElementById('parallelBtn').addEventListener('click', async function() {
            addLog2('--- –ü–ê–†–ê–õ–õ–ï–õ–¨–ù–ê–Ø –ó–ê–ì–†–£–ó–ö–ê ---');
            
            try {
                addLog2('–ó–∞–ø—É—Å–∫–∞–µ–º 3 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞...');
                const [users, products, orders] = await Promise.all([
                    fakeApiRequest('–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 2000),
                    fakeApiRequest('–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤', 1500),
                    fakeApiRequest('–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤', 1800)
                ]);

                addLog2('‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!', 'success');
                addLog2(`‚Ä¢ ${users.data} (${users.timestamp})`);
                addLog2(`‚Ä¢ ${products.data} (${products.timestamp})`);
                addLog2(`‚Ä¢ ${orders.data} (${orders.timestamp})`);
            } catch (error) {
                addLog2(`‚ùå –û–¥–∏–Ω –∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –æ—à–∏–±–∫–æ–π: ${error.message}`, 'error');
            }
        });

        document.getElementById('errorHandlingBtn').addEventListener('click', async function() {
            addLog2('--- –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö ---');
            
            try {
                addLog2('1. –ó–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —É—Å–ø–µ—à–Ω–æ...');
                const successData = await fakeApiRequest('–£—Å–ø–µ—à–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 1000);
                addLog2(`‚úÖ ${successData.data}`, 'success');

                addLog2('2. –ó–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ó–ê–í–ï–†–®–ò–¢–°–Ø –û–®–ò–ë–ö–û–ô...');
                await fakeApiRequest('–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 1000, true);
                addLog2('–≠—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—ã –Ω–µ —É–≤–∏–¥–∏—Ç–µ...');
            } catch (error) {
                addLog2(`‚ùå –ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–∞ –æ—à–∏–±–∫–∞: ${error.message}`, 'error');
                addLog2('3. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏...');
                const recoveryData = await fakeApiRequest('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 800);
                addLog2(`‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: ${recoveryData.data}`, 'success');
            } finally {
                addLog2('üèÅ –ë–ª–æ–∫ finally: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏');
            }
        });
    </script>
</body>
</html>
